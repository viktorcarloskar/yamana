<!DOCTYPE html>
<html>
<head>
	<title></title>
	<link rel="stylesheet" href="/css/reset.css" type="text/css" media="screen" title="no title" charset="utf-8">
	<link rel="stylesheet" href="/css/viewer.css" type="text/css" media="screen" title="no title" charset="utf-8">
	<script src="/socket.io/socket.io.js" type="text/javascript"></script>
	<script>


	window.onload = init;

	var columns = 4;

	var socket = io.connect('http://yamana.herokuapp.com');
	socket.on('conn', function (data) {
		socket.emit('fetch', {var: window.location.pathname.split( '/' )[window.location.pathname.split( '/' ).length - 1]});
	});
	socket.on('instagram', function (data) {
		var main = document.getElementById('main');

		console.log(data);

		var sorted = data.sort(function(a, b){
        return parseInt(a.id) - parseInt(b.id);
    });

		sorted.forEach(function(image) {
			main.innerHTML = newImage(image) + main.innerHTML;
			addImage((Math.floor(Math.random() * columns) + 1), image)
		})

	});

	function addFakeImage() {
		var image = {
			images: {
				standard_resolution: {
					url: 'http://distilleryimage9.s3.amazonaws.com/3c62dff0a90211e38c92125e9fe3ffd9_8.jpg'
				}
			}
		}
		addImage((Math.floor(Math.random() * columns) + 1), image);
	}

	function newImage(col, image)Â {
		var imgHeight = getImgHeight();
		var html = '<img class="image col' + col + ' style="top: -' + imgHeight + 'px" src="' + image.images.standard_resolution.url + '">'
		return html;
	}

	function addImage(col, image) {
		var img = newImage(col, image)
		addImgHtml(img);
		slideDown(col);
	}

	function slideDown(col, img) {
		var colClass = '.col' + col;
		var imgs = document.querySelectorAll(colClass);
		for (var i = 0; i < imgs.length; i++) {
			imgs[i].style.top = (parseInt(imgs[i].style.top, 10) + getImgHeight()) + 'px';
		}
	}
	function addImgHtml(img) {
		var main = document.getElementById('main');
		main.innerHTML = img + main.innerHTML;
	}
	function getImgHeight() {
		var images = document.querySelectorAll('.image');
		var valOne = Math.floor(Math.random() * images.length)
		var valTwo = Math.floor(Math.random() * images.length)

		// IF they are the same value, generate a new
		while (valOne == valTwo && images.length > 1) {
			valTwo = Math.floor(Math.random() * images.length)
		}

		var imageOne = images[valOne]
		var imageTwo = images[valTwo]
		return Math.floor((imageOne.clientHeight + imageTwo.clientHeight) / 2);
	}
	function setImgHeight() {

	}

	function init() {
			var fullscreenBtn = document.getElementById('full-screen');
			var nofullscreenBtn = document.getElementById('hide-flash');
			var fakeImageCreator = document.getElementById('fake-image');
			fullscreenBtn.onclick = function() {
				launchFullscreen(document.documentElement);
				hideFlash();
			}
			nofullscreenBtn.onclick = function() {
				hideFlash();
			}
			fakeImageCreator.onclick = function() {
				addFakeImage();
			}

	}

	function hideFlash() {
		var flash = document.getElementById('flash')
		flash.className += 'animated';
		setTimeout(function() {
			flash.style.display = "none";
		}, 2000);
	}

	function launchFullscreen(element) {
	  if (element.requestFullscreen) {
      element.requestFullscreen();
    } else if (element.msRequestFullscreen) {
      element.msRequestFullscreen();
    } else if (element.mozRequestFullScreen) {
      element.mozRequestFullScreen();
    } else if (element.webkitRequestFullscreen) {
      element.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT);
    }
	}
	</script>
</head>
<body>
	<div id="flash">
		<div id="controls">
			<div id="full-screen">
				Turn on fullscreen
			</div>
			<div id="hide-flash">
				Nah, fullscreen is for fools
			</div>
		</div>
	</div>
	<div id="fake-image">
		DAS FAKE IMG
	</div>
	<div id="main" class="layout1"><img class="image" src="http://distilleryimage10.s3.amazonaws.com/a886c990a90b11e385020a5d4b2ab92e_8.jpg"><img class="image" src="http://distilleryimage10.s3.amazonaws.com/78a4cbb8a90211e3acbc0e58f9837a2a_8.jpg"><img class="image" src="http://distilleryimage9.s3.amazonaws.com/3c62dff0a90211e38c92125e9fe3ffd9_8.jpg"><img class="image" src="http://distilleryimage6.s3.amazonaws.com/e6373650a8ff11e3948f0a4825b4191e_8.jpg"><img class="image" src="http://distilleryimage2.s3.amazonaws.com/e96fde78a6e611e3aceb12f8a5fa1ad6_8.jpg"><img class="image" src="http://distilleryimage7.s3.amazonaws.com/b68aa18ea6df11e3a622128130bd76d7_8.jpg"><img class="image" src="http://distilleryimage4.s3.amazonaws.com/d2d2fee8a6dc11e3bb3a12b8df74a2f4_8.jpg"><img class="image" src="http://distilleryimage4.s3.amazonaws.com/e9e8abc6a6d911e394d312a1aa7ea1d4_8.jpg"><img class="image" src="http://distilleryimage6.s3.amazonaws.com/90f9af42a6d911e3b7ed12d69d74e3c2_8.jpg"><img class="image" src="http://distilleryimage7.s3.amazonaws.com/0b19b9daa6d911e399df12cd97da4603_8.jpg"><img class="image" src="http://distilleryimage10.s3.amazonaws.com/59a9512aa6d711e3834d0e6c3792784e_8.jpg"><img class="image" src="http://distilleryimage8.s3.amazonaws.com/86ae6f58a6d611e3ac3512b9a4187780_8.jpg"><img class="image" src="http://distilleryimage2.s3.amazonaws.com/7f4fb6f0a6d511e3bd5c0e0517cae372_8.jpg"><img class="image" src="http://distilleryimage2.s3.amazonaws.com/215a06f4a6d511e3b6530e9cd22cd9e6_8.jpg"><img class="image" src="http://distilleryimage11.s3.amazonaws.com/3cb3718ea6d411e3b7fd123d3be4afff_8.jpg"><img class="image" src="http://distilleryimage8.s3.amazonaws.com/0f3eaa44a64c11e39b35120dcfb1dcbc_8.jpg"><img class="image" src="http://distilleryimage7.s3.amazonaws.com/fbae0ec8a64811e39ad60e5ae8a94757_8.jpg"><img class="image" src="http://distilleryimage3.s3.amazonaws.com/181e2f30a64811e3bf5c1259423b3b1f_8.jpg"><img class="image" src="http://distilleryimage3.s3.amazonaws.com/f5960ce4a64711e38dac12b1ccdcdf87_8.jpg"><img class="image" src="http://distilleryimage11.s3.amazonaws.com/692a0360a64611e3b1ea0e8b2175c26f_8.jpg"><img class="image" src="http://distilleryimage5.s3.amazonaws.com/bab1fd24a64511e3bcdb12d309462119_8.jpg"><img class="image" src="http://distilleryimage8.s3.amazonaws.com/8e030fdea64511e3b0c612c8413ba65c_8.jpg"><img class="image" src="http://distilleryimage7.s3.amazonaws.com/8c7a2bd477ba11e39dee0a96b9fbd9bb_8.jpg">

	</div>
</body>
</html>
